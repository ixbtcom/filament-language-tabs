# Code Review: LanguageTabs Builder/Repeater Support

> **–î–∞—Ç–∞**: 2025-10-09
> **Reviewer**: Claude Code (code-reviewer + challenge analysis)
> **–§–∞–π–ª**: `src/Forms/Components/LanguageTabs.php`
> **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ**: `tasks/cla-fix.md` (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)

---

## –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ 85%** - –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

**–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ—à–µ–Ω–∏—é**: 9/10 - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–∂–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∞—Å–ø–µ–∫—Ç–∞—Ö

---

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### 1. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Ç–∏–≤–Ω—ã—Ö —Ö—É–∫–æ–≤ Filament ‚úÖ

**–°—Ç—Ä–æ–∫–∏ 378-395:**
```php
protected function getExistingHydrationHook(Component $component): ?Closure
{
    try {
        $reflection = new ReflectionClass($component);
        if (! $reflection->hasProperty('afterStateHydrated')) {
            return null;
        }
        $property = $reflection->getProperty('afterStateHydrated');
        $property->setAccessible(true);
        $hook = $property->getValue($component);
        return $hook instanceof Closure ? $hook : null;
    } catch (ReflectionException) {
        return null;
    }
}
```

**‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞
- `setAccessible(true)` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ protected
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ `instanceof Closure`
- Exception handling —Å graceful fallback

---

### 2. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤—ã–∑–æ–≤–∞ —Ö—É–∫–æ–≤ ‚úÖ

**–°—Ç—Ä–æ–∫–∏ 266-268 (prepareBuilderForLocale):**
```php
if ($existingHydrated !== null) {
    $existingHydrated($component, $state);  // 1Ô∏è‚É£ –ü–ï–†–í–´–ú –Ω–∞—Ç–∏–≤–Ω—ã–π —Ö—É–∫
}
// 2Ô∏è‚É£ –ü–û–¢–û–ú –ª–æ–≥–∏–∫–∞ LanguageTabs
```

**–°—Ç—Ä–æ–∫–∏ 332-334 (prepareRepeaterForLocale):** - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ

**‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç** –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–º—É —Ä–µ—à–µ–Ω–∏—é –∏–∑ `cla-fix.md`.

---

### 3. –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è ‚úÖ

**–°—Ç—Ä–æ–∫–∞ 35:**
```php
protected static array $processedComponents = [];
```

**–°—Ç—Ä–æ–∫–∏ 251-258 (prepareBuilderForLocale):**
```php
$componentId = spl_object_id($builder);
$processKey = "{$componentId}_{$locale}";

if (isset(static::$processedComponents[$processKey])) {
    return;
}
static::$processedComponents[$processKey] = true;
```

**‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ:**
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á —á–µ—Ä–µ–∑ `spl_object_id()` + –ª–æ–∫–∞–ª—å
- Early return –ø—Ä–∏ –¥—É–±–ª–∏–∫–∞—Ç–µ
- –ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

---

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±–æ–∏—Ö –ø—É—Ç–µ–π –≤ refreshFormData ‚úÖ

**–°—Ç—Ä–æ–∫–∏ 305-307 (prepareBuilderForLocale):**
```php
$refresh = [$livewire, 'refreshFormData'];
$refresh(["{$attribute}.{$locale}", $attribute]);  // ‚úÖ –û–ë–ê –ø—É—Ç–∏
```

**–°—Ç—Ä–æ–∫–∏ 167-169 (prepareFieldForLocale):** - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ

**‚úÖ –î–ê–ñ–ï –õ–£–ß–®–ï** —á–µ–º –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–º —Ä–µ—à–µ–Ω–∏–∏ - Field —Ç–æ–∂–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç –æ–±–∞ –ø—É—Ç–∏!

---

### 5. –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–µ–π –≤ render() ‚úÖ

**–°—Ç—Ä–æ–∫–∏ 397-402:**
```php
public function render(): View
{
    static::$processedComponents = [];
    return parent::render();
}
```

**‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç** —Ä–µ—à–µ–Ω–∏—é - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Ç–µ—á–∫—É –ø–∞–º—è—Ç–∏.

---

## ‚ùå –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (—Ç—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

### 1. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–æ–≤ —á–µ—Ä–µ–∑ `!==` –≤–º–µ—Å—Ç–æ `!=` –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–°—Ç—Ä–æ–∫–∏ 283-285 (prepareBuilderForLocale):**
```php
if ($localeData !== $component->getState()) {
    $component->state($localeData);
}
```

**–°—Ç—Ä–æ–∫–∏ 349-351 (prepareRepeaterForLocale):** - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ

**‚ùå –ü–†–û–ë–õ–ï–ú–ê:**

`!==` —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –º–∞—Å—Å–∏–≤—ã **–ø–æ —Å—Å—ã–ª–∫–µ**, –Ω–µ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É:
```php
$a = ['test'];
$b = ['test'];
$a !== $b;  // true (—Ä–∞–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏)
$a != $b;   // false (–æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ)
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –£—Å–ª–æ–≤–∏–µ **–≤—Å–µ–≥–¥–∞ true** –¥–∞–∂–µ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `$component->state()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏—à–Ω–∏–π —Ä–∞–∑
- –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ª–∏—à–Ω–∏–π re-render –≤ Livewire

**üîß –†–ï–®–ï–ù–ò–ï:**

**–í–∞—Ä–∏–∞–Ω—Ç 1 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π):** –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–ª–Ω–æ—Å—Ç—å—é
```php
// –ü—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
$component->state($localeData);
```

**–í–∞—Ä–∏–∞–Ω—Ç 2:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å—Ç—Ä–æ–≥–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
```php
if ($localeData != $component->getState()) {
    $component->state($localeData);
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ **P0** - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º

---

### 2. –¢–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `Field` –≤–º–µ—Å—Ç–æ `Component` –≤ normaliseAttributeState

**–°—Ç—Ä–æ–∫–∞ 174:**
```php
protected function normaliseAttributeState(Field $component, string $attribute, mixed $rawState): array
```

**‚ùå –ü–†–û–ë–õ–ï–ú–ê:**

–ú–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å `Builder $component` –∏ `Repeater $component`:
```php
// –°—Ç—Ä–æ–∫–∞ 276 –≤ prepareBuilderForLocale
$attributeState = $this->normaliseAttributeState($component, $attribute, $attributeState);
                                               // ^^^^^^^^^ Builder, –Ω–µ Field!
```

–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç (Builder –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç Field), –Ω–æ **—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–≤–µ—Ä–Ω–æ**.

**üîß –†–ï–®–ï–ù–ò–ï:**

```php
protected function normaliseAttributeState(Component $component, string $attribute, mixed $rawState): array
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ **P0** - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ç–∏–ø–æ–≤

---

## üî¥ –ü—Ä–æ–±–ª–µ–º—ã –≤—ã—Å–æ–∫–æ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ (P0-P1)

### 3. Race Condition —Å `static $processedComponents`

**–°—Ç—Ä–æ–∫–∞ 35:**
```php
protected static array $processedComponents = [];
```

**üî¥ –ö–†–ò–¢–ò–ß–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:**

Static array **–æ–±—â–∏–π –¥–ª—è –í–°–ï–• –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤** LanguageTabs:
- –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å Octane/FrankenPHP –≤–æ–∑–º–æ–∂–Ω—ã –∫–æ–ª–ª–∏–∑–∏–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –î–≤–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –º–æ–≥—É—Ç —Å–º–µ—à–∞—Ç—å —Å–≤–æ–∏ `$processedComponents`
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–≥—É—Ç –ø–æ–º–µ—á–∞—Ç—å—Å—è –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
```
Request 1: User A —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç Post
Request 2: User B —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç Page
‚Üí static $processedComponents —Å–º–µ—à–∏–≤–∞—é—Ç—Å—è
‚Üí –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

**üîß –†–ï–®–ï–ù–ò–ï:**

**–í–∞—Ä–∏–∞–Ω—Ç 1 (–ø—Ä–æ—Å—Ç–æ–π):** –°–¥–µ–ª–∞—Ç—å instance-level
```php
// –£–±—Ä–∞—Ç—å static
protected array $processedComponents = [];
```

**–í–∞—Ä–∏–∞–Ω—Ç 2 (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–µ—à):** –î–æ–±–∞–≤–∏—Ç—å instance ID
```php
protected static array $processedComponents = [];
protected string $instanceId;

public function __construct(array|Closure $schema)
{
    $this->instanceId = uniqid('lt_', true);
    $this->schema($schema);
}

// –í prepareBuilderForLocale:
$processKey = "{$this->instanceId}_{$componentId}_{$locale}";
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ **P0** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è Octane/production

---

### 4. –†–µ—Ñ–ª–µ–∫—Å–∏—è –≤ –≥–æ—Ä—è—á–µ–º –ø—É—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–°—Ç—Ä–æ–∫–∏ 378-395:**
```php
protected function getExistingHydrationHook(Component $component): ?Closure
{
    $reflection = new ReflectionClass($component);  // ‚ùå –ö–∞–∂–¥—ã–π —Ä–∞–∑!
    // ...
}
```

**üü° –ü–†–û–ë–õ–ï–ú–ê –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò:**

- –†–µ—Ñ–ª–µ–∫—Å–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **–¥–ª—è –ö–ê–ñ–î–û–ì–û –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**
- –§–æ—Ä–º–∞ —Å 10 –ø–æ–ª–µ–π √ó 3 –ª–æ–∫–∞–ª–∏ = **30 –≤—ã–∑–æ–≤–æ–≤** `ReflectionClass`
- Performance overhead: **50-100ms** –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ö
- –ù–∞ —Ñ–æ—Ä–º–∞—Ö —Å ~100 –ø–æ–ª—è–º–∏ –º–æ–∂–µ—Ç –¥–æ—Å—Ç–∏–≥–∞—Ç—å **500ms+**

**üìä –ú–µ—Ç—Ä–∏–∫–∏:**
```
–ü—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º–∞ (5 –ø–æ–ª–µ–π √ó 3 –ª–æ–∫–∞–ª–∏):   15 –≤—ã–∑–æ–≤–æ–≤ ~ 10-15ms
–°—Ä–µ–¥–Ω—è—è —Ñ–æ—Ä–º–∞ (20 –ø–æ–ª–µ–π √ó 3 –ª–æ–∫–∞–ª–∏):  60 –≤—ã–∑–æ–≤–æ–≤ ~ 40-60ms
–°–ª–æ–∂–Ω–∞—è —Ñ–æ—Ä–º–∞ (50 –ø–æ–ª–µ–π √ó 5 –ª–æ–∫–∞–ª–µ–π): 250 –≤—ã–∑–æ–≤–æ–≤ ~ 200-300ms
```

**üîß –†–ï–®–ï–ù–ò–ï:**

–ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Ñ–ª–µ–∫—Å–∏—é **–Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª–∞—Å—Å–∞**:
```php
/**
 * –ö–µ—à ReflectionProperty –¥–ª—è –∫–ª–∞—Å—Å–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
 * @var array<string, \ReflectionProperty>
 */
protected static array $reflectionCache = [];

protected function getExistingHydrationHook(Component $component): ?Closure
{
    try {
        $class = get_class($component);

        // –ö–µ—à–∏—Ä—É–µ–º ReflectionProperty –¥–ª—è –∫–ª–∞—Å—Å–∞
        if (!isset(static::$reflectionCache[$class])) {
            $reflection = new ReflectionClass($component);

            if (!$reflection->hasProperty('afterStateHydrated')) {
                static::$reflectionCache[$class] = false;
                return null;
            }

            $property = $reflection->getProperty('afterStateHydrated');
            $property->setAccessible(true);
            static::$reflectionCache[$class] = $property;
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        if (static::$reflectionCache[$class] === false) {
            return null;
        }

        $hook = static::$reflectionCache[$class]->getValue($component);

        return $hook instanceof Closure ? $hook : null;
    } catch (ReflectionException) {
        return null;
    }
}
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤: ~1-2ms (—Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏)
- ‚úÖ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ: ~0.01ms (—á—Ç–µ–Ω–∏–µ –∏–∑ –∫–µ—à–∞)
- ‚úÖ –£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ **100-200 —Ä–∞–∑** –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **P1** - –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è production

---

### 5. –•—Ä—É–ø–∫–æ—Å—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Filament

**–°—Ç—Ä–æ–∫–∏ 266-268:**
```php
if ($existingHydrated !== null) {
    $existingHydrated($component, $state);
}
```

**üü° –ü–†–û–ë–õ–ï–ú–ê:**

–ö–æ–¥ **–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç**, —á—Ç–æ `afterStateHydrated` –≤—Å–µ–≥–¥–∞ `Closure|null`. –ù–æ Filament –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å:

```php
// –ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º Filament —Å–¥–µ–ª–∞–µ—Ç:
protected array $afterStateHydrated = [];  // –ú–∞—Å—Å–∏–≤ —Ö—É–∫–æ–≤!

// –ù–∞—à –∫–æ–¥ —É–ø–∞–¥—ë—Ç —Å:
// TypeError: array is not callable
```

**üîß –†–ï–®–ï–ù–ò–ï:**

–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–∏–ø–∞:
```php
protected function getExistingHydrationHook(Component $component): ?Closure
{
    try {
        // ... —Ä–µ—Ñ–ª–µ–∫—Å–∏—è ...

        $hook = $property->getValue($component);

        // ‚úÖ –ó–ê–©–ò–¢–ê: –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —ç—Ç–æ Closure
        if ($hook instanceof Closure) {
            return $hook;
        }

        // –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û: –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –µ—Å–ª–∏ –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ç–∏–ø
        if ($hook !== null) {
            \Log::warning('Unexpected afterStateHydrated type', [
                'component' => get_class($component),
                'type' => get_debug_type($hook),
            ]);
        }

        return null;
    } catch (ReflectionException) {
        return null;
    }
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **P1** - –∑–∞—â–∏—Ç–∞ –æ—Ç –±—É–¥—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üü° –ü—Ä–æ–±–ª–µ–º—ã —Å—Ä–µ–¥–Ω–µ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ (P2)

### 6. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ PHPDoc –¥–ª—è –º–µ—Ç–æ–¥–æ–≤

**–°—Ç—Ä–æ–∫–∏ 246-250:**
```php
protected function prepareBuilderForLocale(
    Builder $builder,
    string $attribute,
    string $locale
): void {
```

**üü° –ü–†–û–ë–õ–ï–ú–ê:**

–ù–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞
- –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `$attribute`
- –ö–∞–∫–∏–µ –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã

**üîß –†–ï–®–ï–ù–ò–ï:**

```php
/**
 * –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç Builder –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª–∏.
 *
 * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–∞—Ç–∏–≤–Ω—ã–π —Ö—É–∫ –≥–∏–¥—Ä–∞—Ç–∞—Ü–∏–∏ Filament –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏,
 * —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç Builder –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å Items —Å UUID-–∫–ª—é—á–∞–º–∏.
 * –î–æ–±–∞–≤–ª—è–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É JSON-–ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ –º–æ–¥–µ–ª–∏
 * –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º Builder –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ª–æ–∫–∞–ª–∏.
 *
 * @param Builder $builder –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Builder –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
 * @param string $attribute –ë–∞–∑–æ–≤—ã–π –∞—Ç—Ä–∏–±—É—Ç –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'content')
 * @param string $locale –ö–æ–¥ –ª–æ–∫–∞–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'en', 'de')
 * @return void
 */
protected function prepareBuilderForLocale(
    Builder $builder,
    string $attribute,
    string $locale
): void {
```

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è:
- `prepareRepeaterForLocale()`
- `getExistingHydrationHook()`

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **P2** - –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è maintainability

---

### 7. O(n) –ø–æ–∏—Å–∫ –≤ normaliseAttributeState

**–°—Ç—Ä–æ–∫–∞ 176:**
```php
if (in_array($attribute, $this->normalisedAttributes, true) && is_array($rawState)) {
    return $rawState;
}
```

**üü° –ü–†–û–ë–õ–ï–ú–ê:**

`in_array()` –Ω–∞ —Ä–∞—Å—Ç—É—â–µ–º –º–∞—Å—Å–∏–≤–µ - **O(n)**:
- 1-–µ –ø–æ–ª–µ: 1 –∏—Ç–µ—Ä–∞—Ü–∏—è
- 50-–µ –ø–æ–ª–µ: 50 –∏—Ç–µ—Ä–∞—Ü–∏–π
- –û–±—â–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å: **O(n¬≤)**

–ù–∞ —Ñ–æ—Ä–º–∞—Ö —Å ~100 –ø–æ–ª—è–º–∏ = **~5000 –ø—Ä–æ–≤–µ—Ä–æ–∫** –≤–º–µ—Å—Ç–æ 100.

**üîß –†–ï–®–ï–ù–ò–ï:**

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å hash map:
```php
// –°—Ç—Ä–æ–∫–∞ 30
protected array $normalisedAttributes = [];

// –í normaliseAttributeState
if (isset($this->normalisedAttributes[$attribute]) && is_array($rawState)) {
    return $rawState;
}

// ...

$this->normalisedAttributes[$attribute] = true;  // –í–º–µ—Å—Ç–æ []
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞: O(n) ‚Üí **O(1)**
- ‚úÖ –î–ª—è 100 –ø–æ–ª–µ–π: ~5000 –ø—Ä–æ–≤–µ—Ä–æ–∫ ‚Üí **100 –ø—Ä–æ–≤–µ—Ä–æ–∫**

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **P2** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–æ—Ä–º

---

### 8. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ `getTranslations()` –≤ –º–æ–¥–µ–ª–∏

**–°—Ç—Ä–æ–∫–∞ 197:**
```php
$translations = $record->getTranslations($attribute);
```

**üü° –ü–†–û–ë–õ–ï–ú–ê:**

–ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —á—Ç–æ –º–æ–¥–µ–ª—å **–∏–º–µ–µ—Ç** `getTranslations()`:
```php
// –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HasTranslations trait:
Fatal error: Call to undefined method getTranslations()
```

**üîß –†–ï–®–ï–ù–ò–ï:**

```php
protected function normaliseAttributeState(Component $component, string $attribute, mixed $rawState): array
{
    if (in_array($attribute, $this->normalisedAttributes, true) && is_array($rawState)) {
        return $rawState;
    }

    $record = $this->resolveRecord($component);

    // ‚úÖ –ü–†–û–í–ï–†–ö–ê
    if (!$record || !method_exists($record, 'getTranslations')) {
        return is_array($rawState) ? $rawState : [];
    }

    $translations = $record->getTranslations($attribute);

    // ...
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° **P2** - –∑–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

## üü¢ –£–ª—É—á—à–µ–Ω–∏—è –Ω–∏–∑–∫–æ–≥–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ (P3)

### 9. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∫–∞—Å–∫–∞–¥ refreshFormData

**–°—Ç—Ä–æ–∫–∏ 305-307:**
```php
if (method_exists($livewire, 'refreshFormData')) {
    $refresh = [$livewire, 'refreshFormData'];
    $refresh(["{$attribute}.{$locale}", $attribute]);
}
```

**üü¢ –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:**

–°—Ü–µ–Ω–∞—Ä–∏–π:
1. User –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª–µ A
2. `afterStateUpdated` ‚Üí `refreshFormData(['A'])`
3. Filament –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º—ã–µ –ø–æ–ª—è B, C
4. –ò—Ö —Ö—É–∫–∏ —Ç–æ–∂–µ –≤—ã–∑—ã–≤–∞—é—Ç `refreshFormData()`
5. –í–æ–∑–º–æ–∂–µ–Ω **–∫–∞—Å–∫–∞–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π** –∏–ª–∏ –¥–∞–∂–µ —Ü–∏–∫–ª

**üîß –†–ï–®–ï–ù–ò–ï (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**

```php
protected bool $isRefreshing = false;

protected function refreshFormDataSafe(array $paths, $livewire): void
{
    // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã
    if ($this->isRefreshing) {
        return;
    }

    try {
        $this->isRefreshing = true;

        if (method_exists($livewire, 'refreshFormData')) {
            $livewire->refreshFormData($paths);
        }
    } finally {
        $this->isRefreshing = false;
    }
}
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ **P3** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã

---

### 10. –í–ª–æ–∂–µ–Ω–Ω—ã–µ Builder –≤–Ω—É—Ç—Ä–∏ Builder

**üü¢ EDGE CASE:**

```php
LanguageTabs::make([
    Builder::make('content')
        ->blocks([
            Block::make('section')
                ->schema([
                    Builder::make('nested_content'),  // ‚Üê –í–ª–æ–∂–µ–Ω–Ω—ã–π Builder
                ])
        ])
])
```

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –¢–µ–∫—É—â–∏–π –∫–æ–¥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ **top-level** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ Builder **–Ω–µ –ø–æ–ª—É—á–∞—é—Ç** —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
- –ò—Ö —Ö—É–∫–∏ –º–æ–≥—É—Ç –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –ª–æ–∫–∞–ª—è–º–∏

**üîß –†–ï–®–ï–ù–ò–ï (–µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å):**

–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–∫–∞–∫ –ø—Ä–µ–¥–ª–∞–≥–∞–ª–æ—Å—å –≤ `cla-fix.md` —Å—Ç—Ä–æ–∫–∏ 295-360).

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ **P3** - —Ä–µ–¥–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π, –º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–æ–±–ª–µ–º

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –†–∏—Å–∫ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –°—Ç—Ä–æ–∫–∏ |
|---|----------|-----------|------|-----------|--------|
| 1 | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ `!==` –¥–ª—è –º–∞—Å—Å–∏–≤–æ–≤ | üî¥ P0 | –°—Ä–µ–¥–Ω–∏–π | –¢—Ä–∏–≤–∏–∞–ª—å–Ω–∞—è | 283, 349 |
| 2 | –¢–∏–ø `Field` –≤–º–µ—Å—Ç–æ `Component` | üî¥ P0 | –ù–∏–∑–∫–∏–π | –¢—Ä–∏–≤–∏–∞–ª—å–Ω–∞—è | 174 |
| 3 | Race condition `static array` | üî¥ P0 | –í—ã—Å–æ–∫–∏–π | –õ–µ–≥–∫–∞—è | 35, 251-258 |
| 4 | –†–µ—Ñ–ª–µ–∫—Å–∏—è –≤ –≥–æ—Ä—è—á–µ–º –ø—É—Ç–∏ | üü° P1 | –°—Ä–µ–¥–Ω–∏–π | –°—Ä–µ–¥–Ω—è—è | 378-395 |
| 5 | –•—Ä—É–ø–∫–æ—Å—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ö—É–∫–æ–≤ | üü° P1 | –°—Ä–µ–¥–Ω–∏–π | –õ–µ–≥–∫–∞—è | 266-268 |
| 6 | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ PHPDoc | üü° P2 | –ù–∏–∑–∫–∏–π | –õ–µ–≥–∫–∞—è | 246, 312, 378 |
| 7 | O(n) –ø–æ–∏—Å–∫ –≤ –º–∞—Å—Å–∏–≤–µ | üü° P2 | –ù–∏–∑–∫–∏–π | –¢—Ä–∏–≤–∏–∞–ª—å–Ω–∞—è | 176 |
| 8 | –ü—Ä–æ–≤–µ—Ä–∫–∞ `getTranslations()` | üü° P2 | –°—Ä–µ–¥–Ω–∏–π | –¢—Ä–∏–≤–∏–∞–ª—å–Ω–∞—è | 197 |
| 9 | –ö–∞—Å–∫–∞–¥ `refreshFormData` | üü¢ P3 | –ù–∏–∑–∫–∏–π | –°—Ä–µ–¥–Ω—è—è | 305-307 |
| 10 | –í–ª–æ–∂–µ–Ω–Ω—ã–µ Builder | üü¢ P3 | –ù–∏–∑–∫–∏–π | –í—ã—Å–æ–∫–∞—è | - |

---

## üõ†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (P0)

**–ü–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:**

1. **–£–±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `!==` –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `!=`** (—Å—Ç—Ä–æ–∫–∏ 283, 349)
   ```diff
   - if ($localeData !== $component->getState()) {
   -     $component->state($localeData);
   - }
   + $component->state($localeData);
   ```

2. **–ò–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –Ω–∞ `Component`** (—Å—Ç—Ä–æ–∫–∞ 174)
   ```diff
   - protected function normaliseAttributeState(Field $component, ...
   + protected function normaliseAttributeState(Component $component, ...
   ```

3. **–£–±—Ä–∞—Ç—å `static` –∏–∑ `$processedComponents`** (—Å—Ç—Ä–æ–∫–∞ 35)
   ```diff
   - protected static array $processedComponents = [];
   + protected array $processedComponents = [];
   ```

**–í—Ä–µ–º—è**: ~10 –º–∏–Ω—É—Ç
**–†–∏—Å–∫**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

---

### üîß –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (P1)

**–ü–æ—Å–ª–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**

4. **–ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Ñ–ª–µ–∫—Å–∏—é** - —Å–º. —Ä–µ—à–µ–Ω–∏–µ –≤ —Ä–∞–∑–¥–µ–ª–µ #4
5. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–∏–ø–∞ —Ö—É–∫–∞** - —Å–º. —Ä–µ—à–µ–Ω–∏–µ –≤ —Ä–∞–∑–¥–µ–ª–µ #5

**–í—Ä–µ–º—è**: ~30-60 –º–∏–Ω—É—Ç
**–≠—Ñ—Ñ–µ–∫—Ç**: +20-30% –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ö

---

### üí° –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (P2-P3)

**–ï—Å–ª–∏ –±—É–¥–µ—Ç –≤—Ä–µ–º—è:**

6. –î–æ–±–∞–≤–∏—Ç—å PHPDoc –¥–ª—è –º–µ—Ç–æ–¥–æ–≤
7. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å `in_array` –Ω–∞ hash map
8. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `getTranslations()`
9. –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–∞—Å–∫–∞–¥–∞ `refreshFormData`

**–í—Ä–µ–º—è**: ~1-2 —á–∞—Å–∞
**–≠—Ñ—Ñ–µ–∫—Ç**: –õ—É—á—à–∞—è maintainability –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å

---

## üéØ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (15 –º–∏–Ω—É—Ç)

```bash
# 1. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª
code src/Forms/Components/LanguageTabs.php

# 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å 3 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è P0
# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏
composer pint
vendor/bin/phpstan analyse
```

**–ß–µ–∫–ª–∏—Å—Ç:**
- [ ] –£–±—Ä–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `!==` (—Å—Ç—Ä–æ–∫–∏ 283, 349)
- [ ] –ò–∑–º–µ–Ω–µ–Ω —Ç–∏–ø `Field ‚Üí Component` (—Å—Ç—Ä–æ–∫–∞ 174)
- [ ] –£–±—Ä–∞–Ω `static` –∏–∑ `$processedComponents` (—Å—Ç—Ä–æ–∫–∞ 35)
- [ ] Pint –ø—Ä–æ–π–¥–µ–Ω
- [ ] PHPStan –ø—Ä–æ–π–¥–µ–Ω

---

### –≠—Ç–∞–ø 2: –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1 —á–∞—Å)

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–µ—à —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ö—É–∫–∞
- [ ] PHPStan level 5 –ø—Ä–æ–π–¥–µ–Ω

---

### –≠—Ç–∞–ø 3: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (1 —á–∞—Å)

- [ ] –î–æ–±–∞–≤–ª–µ–Ω PHPDoc –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
- [ ] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–∏—Å–∫ –≤ `normalisedAttributes`
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `getTranslations()`

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ Builder —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö –ª–æ–∫–∞–ª—è—Ö
- ‚úÖ Repeater —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö –ª–æ–∫–∞–ª—è—Ö
- ‚úÖ –ù–∞—Ç–∏–≤–Ω—ã–µ —Ö—É–∫–∏ Filament —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ø–æ—Å–ª–µ P1)
- ‚úÖ –†–µ—Ñ–ª–µ–∫—Å–∏—è –∫–µ—à–∏—Ä—É–µ—Ç—Å—è ‚Üí **+100-200x** —Å–∫–æ—Ä–æ—Å—Ç—å
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è O(1) –≤–º–µ—Å—Ç–æ O(n) ‚Üí **+50-100%** –Ω–∞ –±–æ–ª—å—à–∏—Ö —Ñ–æ—Ä–º–∞—Ö
- ‚úÖ –ù–µ—Ç race conditions ‚Üí —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞ Octane

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞
- ‚úÖ PHPStan level 4+ –ø—Ä–æ—Ö–æ–¥–∏—Ç
- ‚úÖ –¢–∏–ø—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚úÖ PHPDoc –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- ‚úÖ –ù–µ—Ç potential bugs

---

## üí¨ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Ç–∏–≤–Ω—ã—Ö —Ö—É–∫–æ–≤ —á–µ—Ä–µ–∑ —Ä–µ—Ñ–ª–µ–∫—Å–∏—é
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤—ã–∑–æ–≤–∞ —Ö—É–∫–æ–≤
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±–æ–∏—Ö –ø—É—Ç–µ–π (–¥–∞–∂–µ –ª—É—á—à–µ —á–µ–º –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏!)
- –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–µ–π

**‚ùå –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- 3 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º—ã (P0) - **15 –º–∏–Ω—É—Ç –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**
- 2 –≤–∞–∂–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏—è (P1) - **1 —á–∞—Å –Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é**

### –í–µ—Ä–¥–∏–∫—Ç

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è **—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞** –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è 3-—Ö —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º P0.

–ö–æ–¥ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç **—Ö–æ—Ä–æ—à–µ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ** –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –∏ –¥–∞–∂–µ **—É–ª—É—á—à–∞–µ—Ç** –µ–≥–æ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∞—Å–ø–µ–∫—Ç–∞—Ö (refreshFormData –¥–ª—è Field).

–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∏—Å–∫–∏ —Å–≤—è–∑–∞–Ω—ã —Å **–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é** (—Ä–µ—Ñ–ª–µ–∫—Å–∏—è) –∏ **race conditions** (static array), –∫–æ—Ç–æ—Ä—ã–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è production —Å Octane.

**–û—Ü–µ–Ω–∫–∞**: **8.5/10** - –æ—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–æ—Ä–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π.

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

### –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

1. **–°–µ–π—á–∞—Å**: –ü—Ä–∏–º–µ–Ω–∏—Ç—å 3 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è P0 (15 –º–∏–Ω—É—Ç)
2. **–°–µ–≥–æ–¥–Ω—è**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å P1 (–∫–µ—à —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏) (1 —á–∞—Å)
3. **–ù–∞ –Ω–µ–¥–µ–ª–µ**: –î–æ–±–∞–≤–∏—Ç—å PHPDoc –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ P2
4. **–ü–æ—Ç–æ–º**: –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã (–æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–µ—Ä–µ–¥ production —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ —Å Builder –≤ —Ä–∞–∑–Ω—ã—Ö –ª–æ–∫–∞–ª—è—Ö
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ Items
- [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ç–∞–±–∞–º–∏
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
- [ ] –†–∞–±–æ—Ç–∞ –≤ Octane (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ —Ä–µ–ª–∏–∑–∞

–°–ª–µ–¥–∏—Ç—å –∑–∞:
- Response time —Ñ–æ—Ä–º —Å Builder
- Memory usage –Ω–∞ —Ñ–æ—Ä–º–∞—Ö —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–æ–ª–µ–π
- –û—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ä–µ—Ñ–ª–µ–∫—Å–∏–µ–π
- –ñ–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
